<?xml version="1.0" encoding="utf-8" ?>
<!-- 
    Copyright 2022 Mon Logistics Group <https://www.mlholding.mn>
     Created by Umbaa. 2022-12-02
 -->
<odoo>
    
    <record id="ml_worldwide_freight_form_view" model="ir.ui.view">
        <field name="name">mlworldwide.freights.form</field>
        <field name="model">mlworldwide.freights</field>
        <field name="arch" type="xml">
            <form string="Freights">
                <header>
                    <field eval="1" name="cancel_active" invisible="1"/>
                    <field name="state_buttons" invisible="1"/>
                    <button type="object" string="Send Track" name="send_truck" attrs="{'invisible': [ ('cancel_active', '=', False)]}" />
                    <button type="object" string="FeedBack Mail" name="feedback_email" attrs="{'invisible': [ ('cancel_active', '=', False)]}" />
                    <button type="object" string="Quotation" name="freight_quotation" attrs="{'invisible': [ ('state_buttons', '=', False)]}" groups="ml_worldwide-main.group_mlworldwide_sales,ml_worldwide-main.group_mlworldwide_manager"/>
                    <button type="object" string="Re-inquiry" name="freight_reinquiry" attrs="{'invisible': [ ('state_buttons', '=', False)]}" groups="ml_worldwide-main.group_mlworldwide_pd,ml_worldwide-main.group_mlworldwide_pd_manager"/>
                    <button type="object" string="closed" name="freight_closed" attrs="{'invisible': [ ('state_buttons', '=', False)]}" groups="ml_worldwide-main.group_mlworldwide_sales,ml_worldwide-main.group_mlworldwide_manager"/>
                    <button type="object" string="Cancel" name="freight_cancel" attrs="{'invisible': [('cancel_active', '=', False)]}" groups="ml_worldwide-main.group_mlworldwide_sales,ml_worldwide-main.group_mlworldwide_manager"/>
                    <button name="toggle_active" string="Restore" type="object" data-hotkey="z"
                            attrs="{'invisible': [ ('cancel_active', '=', True)]}"/>
                    <field name="agent_inquiry_mail_subject" invisible="1"/>
                    <!-- <field name="state" invisible="1"/> -->
                    <field name="employee" invisible="1"/>
                    <!-- <field name="state_click" invisible="1"/> -->
                    <field name="state_id" widget="statusbar" options="{'clickable': 0}" />
                    <field name="show_quotation" invisible="1"/>
                </header>
                <sheet string="DATA">
                    <div class="ribbon ribbon-top-right" style="pointer-events: none; margin-top:10px;" attrs="{'invisible': [ ('cancel_active', '=', True)]}" >
                        <span style="font-size:12px; margin-top:-10px; margin-left:-10px;" class="bg-danger">Cancelled</span>
                    </div>
                    
                    <div class="o_not_full oe_left viewdetails" style="margin-top:-7px;" attrs="{'invisible': [ ('is_show_details', '=', True)]}">
                        <field name="is_show_details" nolabel="1"/>
                    </div> 
                    <div class="o_not_full oe_left viewdetails1"  style="margin-top:-7px;" attrs="{'invisible': [ ('is_show_details', '=', False)]}">
                        <field name="is_show_details" nolabel="1"/>
                    </div>
                    
                    <!-- <center style="margin-top:10px;"><h2><field name="ref_num" attrs="{'readonly': True}"/> </h2></center> -->
                    <div class="oe_button_box" name="button_box" >
                        <button name="action_view_invoice"
                            type="object"
                            class="oe_stat_button"
                            icon='fa-building' 
                            style='color:green'
                            attrs="{'invisible': [('invoice_count', '=', 0)]}">
                            <field name="invoice_count" widget="statinfo" string="Invoices"/>
                        </button>
                        <button name="action_view_services"
                            type="object"
                            class="oe_stat_button"
                            icon='fa-building-o' 
                            style='color:red'
                            attrs="{'invisible': [('service_count', '=', 0)]}">
                            <field name="service_count" widget="statinfo" string="Services"/>
                        </button>
                    </div>
                    
                    <div class="oe_spaced" >  
                        <h2><field name="ref_num" attrs="{'readonly': True}"/> </h2>                      
                        <div class="oe_left" style="font-size:18px;">
                            <field name="lost_reason" readonly= "1" attrs="{'invisible': [ ('cancel_active', '=', True)]}"/>
                            <div>
                                <field name="note" readonly= "1"  attrs="{'invisible': [ ('cancel_active', '=', True)]}" />
                            </div>
                        </div>
                    </div>
                     
                    <notebook>
                        <page string="General" name="general" autofocus="True">
                            <group expand="1" string="General data">
                                <group>
                                    <!-- <field name='note' readonly='1'/> -->
                                    <field name="is_prepaid" attrs="{'value': True}"/>
                                    <field name="is_export"/>
                                    <field name="customer_id" options="{'no_create': True, 'no_create_edit':True}"/>
                                    <field name="origin_term" options="{'no_create': True, 'no_create_edit':True}"/>
                                    <field name="incoterm_uses_address" invisible="1"/>
                                    <field name="origin_point_id" options="{'no_create': True, 'no_create_edit':True}"/>
                                    <field name="pickup_address" attrs="{'invisible': [('incoterm_uses_address','!=','EXW')], 'required' : [('incoterm_uses_address', '=', 'EXW')]}"/>
                                </group>
                                <group>
                                    <field name="has_insurance" />
                                    
                                    <field name="dangerous_goods" />
                                    <field name="contributor_ids" widget="many2many_tags" options="{'no_create': True, 'no_create_edit':True}"/>
                                    <field name="destination_term" options="{'no_create': True, 'no_create_edit':True}"/>
                                    <field name="delivery_uses_address" invisible="1"/>
                                    <field name="destination_point_id" options="{'no_create': True, 'no_create_edit':True}"/>
                                    <field name="delivery_address" attrs="{'invisible': [('delivery_uses_address','!=','DAP')], 'required' : [('delivery_uses_address','=','DAP')]}"/>
                                </group>
                            </group>
                            
                            <group expand="1" string="Shipper info" attrs="{'invisible': [('is_show_details', '=', False)]}">
                                <group>
                                    <field name="shipper_info" />
                                </group>
                                <group>
                                    <field name="shipper_detail" />
                                </group>
                            </group>

                            <group expand="1" string="Cargo info" attrs="{'invisible': [('is_show_details', '=', False)]}">
                                <group>
                                    <field name="hscode_category_id" options="{'no_create': True, 'no_create_edit':True}"/>
                                    <field name="hs_code" attrs="{'required' : [('show_hscode','=',True)]}"/>
                                </group>
                                <group>
                                    <field name="notes" />
                                </group>
                            </group>
                            
                            <group expand="1" string="Other info" attrs="{'invisible': [('is_show_details', '=', False)]}">
                                <group>
                                    <field name="freigths_type" widget="many2many_tags" options="{'no_create': True, 'no_create_edit':True}"/>
                                    <field name="show_tara" invisible="1"/>
                                    <field name="show_wgn" invisible="1"/>
                                    <field name="show_truck" invisible="1"/>
                                    <field name="show_volgross" invisible="1"/>
                                    <field name="show_hscode" invisible="1"/>
                                    <field name="show_remark" invisible="1"/>
                                    <field name="taras_id"  widget="many2many_tags" attrs="{'invisible': [('show_tara','!=', True)],'required' : [('show_tara','=',True)]}" options="{'no_create': True, 'no_create_edit':True}"/>
                                    <field name="package_qty" />
                                    <field name="volume" attrs="{'required' : [('show_volgross','=',True)]}" widget="float"/>
                                    <field name="gross" attrs="{'required' : [('show_volgross','=',True)]}" widget="float"/>
                                    <field name="terminal_id"/>
                                </group>
                                <group>
                                    <field name="shipment_qty" attrs="{'invisible': [('show_tara','!=', True)],'required' : [('show_tara','=',True)]}"/>
                                    <field name="fclroute_ids" widget="many2many_tags" attrs="{'invisible': [('show_tara','!=', True)],'required' : [('show_tara','=',True)]}" options="{'no_create': True, 'no_create_edit':True}"/>
                                    <field name="ref"/>
                                    <field name="temperature" attrs="{'invisible': [('ref','!=', True)], 'required' : [('ref','=',True)]}"/>
                                    <field name="wagon_type_id" attrs="{'invisible': [('show_wgn','!=', True)], 'required' : [('show_wgn','=',True)]}" options="{'no_create': True, 'no_create_edit':True}"/>
                                    <field name="truck_type_id" attrs="{'invisible': [('show_truck','!=', True)], 'required' : [('show_truck','=',True)]}" options="{'no_create': True, 'no_create_edit':True}"/>
                                    <field name="employee" />
                                </group>
                            </group>
                            
                            <group string="REMARK" attrs="{'invisible': [('is_show_details', '=', False)]}">    
                                <field name="local_remark" attrs="{'required' : [('show_remark','=',True)]}"/>
                                <field name="notice"/>
                                <field name="remark" />
                                <field name="invoice_id" widget="many2many_taglinks" /> 
                                <field name="attachement_ids" widget="many2many_binary" attrs="{'required' : [('show_hscode','=',True)]}"/>
                            </group>
                        </page>
                        <page string="Agent inquiry" name="inquiry" attrs="{'invisible': [('show_quotation','!=',True)]}">
                            <header>
                                <button name='search_create_wizard' string='Agent search' type='object'/>
                            </header>
                            <field name="freights_inquiries" context="{'default_freight_id': id}">
                                <kanban>
                                    <field name="agent_id"></field>
                                    <!-- <field name="origin_term"/> -->
                                    <field name="origin_point_id"/>
                                    <field name="agent_costs_ids" widget="many2many"/>
                                    <field name="destination_point_id"/>
                                    <field name="freigths_type"/>
                                    <field name="taras_id"/>
                                    <field name="container_type"/>
                                    <field name="remark"/>
                                    <field name="show_tara" invisible="1"/>
                                    <field name="show_volgross" invisible="1"/>
                                    <field name="checker" invisible="1"/>
                                    <templates>
                                        <t t-name="kanban-box">
                                            <!-- <t t-if="record.agent_costs_ids.raw_value &gt; 0">
                                                <div t-attf-class="oe_kanban_content oe_kanban_global_click oe_semantic_html_override oe_kanban_color_1" style="background-color: #00FF0033;">
                                                    <div class="o_kanban_card_content">
                                                        <h2><field name="agent_id"/></h2>
                                                        
                                                        <div class="o_field_many2manytags o_field_widget"> 
                                                            <div class="badge-pill o_tag_color_7" style="float:left;margin-right:8px;">
                                                                <field name="freigths_type"/> 
                                                            </div> 
                                                        </div>
                                                        

                                                        <div class="d-flex flex-column">
                                                            <div><field name="origin_point_id" />-<field name="destination_point_id" /></div>
                                                            <div><t t-out="taras_id"/></div>
                                                           
                                                        </div>

                                                        <div class="o_field_many2manytags o_field_widget o_quick_editable">
                                                            <div class="badge badge-pill dropdown o_tag_color_10" style="float:left;">
                                                                <span class="o_tag_badge_text">Vendor / Desk Manufacturers</span>
                                                            </div>
                                                            <div class="badge badge-pill dropdown o_tag_color_4" style="float:left;">
                                                                <span class="o_tag_badge_text">Employees</span>
                                                            </div>
                                                            <div class="badge badge-pill dropdown o_tag_color_7" style="float:left;">
                                                                <span class="o_tag_badge_text">Services</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </t>"freigths_type.display_name == 'FCL'
                                            <t t-else="">
                                                <div t-attf-class="oe_kanban_content oe_kanban_global_click oe_semantic_html_override oe_kanban_color_2" style="background-color: #0000FF33;">
                                                    <div class="o_kanban_card_content">
                                                        <h2><field name="agent_id"/></h2>
                                                        <strong class="o_kanban_record_title">
                                                            <field name="freigths_type"/>
                                                        </strong>
                                                        <div class="d-flex flex-column">
                                                            <div><field name="origin_point_id" />-<field name="destination_point_id" /></div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </t> -->
                                            <div t-attf-class="oe_kanban_content oe_kanban_global_click oe_semantic_html_override oe_kanban_color_1" style="background-color: #00FF0033;">
                                                <div class="d-flex flex-column">
                                                    <div><field name="origin_point_id" />-<field name="destination_point_id" /></div>
                                                    <div class="o_field_many2manytags o_field_widget"> 
                                                        <div class="badge-pill o_tag_color_7" style="float:right;margin-top:-12px;">
                                                            <field name="create_date"/> 
                                                            <t t-if="record.checker.raw_value === true" >
                                                                Sent
                                                            </t>
                                                        </div> 
                                                    </div>
                                                    Agents: 
                                                    <div class="o_field_many2manytags o_field_widget"> 
    
                                                        <div>
                                                            <field name="agent_id"/> 
                                                            
                                                        </div> 
                                                    </div>
                                                    <t t-if="record.show_tara.raw_value === true" >
                                                        <div class="o_field_many2manytags o_field_widget o_quick_editable">
                                                            <div class="badge-pill dropdown o_tag_color_10" style="float:left; size:5px; list-style-type: none;" >
                                                                <span class="o_tag_badge_text"><field name="taras_id"/></span>
                                                            </div>
                                                            <div class="badge badge-pill dropdown o_tag_color_4" style="float:left;">
                                                                <span class="o_tag_badge_text"><field name="container_type"/></span>
                                                            </div>
                                                            <div class="badge badge-pill dropdown o_tag_color_7" style="float:left;">
                                                                <span class="o_tag_badge_text"><field name="shipping_line"/></span>
                                                            </div>
                                                        
                                                        </div>
                                                    </t>
                                                    <!-- <t t-if="record.show_hscode.raw_value === true">
                                                        <div class="badge-pill dropdown o_tag_color_10" style="float:left; size:5px; list-style-type: none;" >
                                                            <span class="o_tag_badge_text"><field name="volume"/></span>
                                                        </div>
                                                        <div class="badge badge-pill dropdown o_tag_color_4" style="float:left;">
                                                            <span class="o_tag_badge_text"><field name="gross"/></span>
                                                        </div>
                                                    </t> -->
                                                    <t t-if="record.show_volgross.raw_value === true">
                                                        <div class="o_field_many2manytags o_field_widget o_quick_editable">
                                                            <div class="badge-pill dropdown o_tag_color_10" style="float:left; size:5px; list-style-type: none;" >
                                                                <span class="o_tag_badge_text"><field name="volume"/>kg</span>
                                                            </div>
                                                            <div class=" badge-pill dropdown o_tag_color_4" style="float:left;">
                                                                <span class="o_tag_badge_text"><field name="gross"/>cbm</span>
                                                            </div>
                                                        </div>
                                                    </t>
                                                </div>

                                            </div>
                                        </t>
                                    </templates>
                                </kanban>
                            </field>
                        </page>
                        <page string="Quotation" name="quotations" attrs="{'invisible': [('show_quotation','!=',True)]}">
                            <field name='state_checker' invisible="1"/>
                            <field name="freights_quotations" context="{'default_freight_id': id}" attrs="{'readonly':[('state_checker','=',True)]}" mode="kanban">
                                <kanban class="o_kanban_mobile">
                                    <control>
                                        <create name="add_product_control" string="Add a Service" />
                                    </control>
                                    <field name="employee"/>
                                    <field name="quote_name" />
                                    <field name="is_active_view" />
                                    <field name="is_send_email" />
                                    <field name="is_confirmed" />
                                    <field name="quote_cost" widget="monetary" />
                                    <field name='picked_bool' invisible='1'/>
                                    <field name='quotation_ref_num'/>
                                    <field name="valid_until_date" />
                                    <field name="service_ids" widget="one2many" modde="kanban"/>
                                    <field name="agent_id"/>
                                    <field name="total_cost" widget='monetary'/>
                                    <field name="ett_min"/>
                                    <field name="ett_max"/>
                                    <field name ="quotation_data"/>
                                    <templates>
                                        <t t-name="kanban-box">
                                            <t t-set="data" t-value="record.quotation_data.raw_value.split('||')"/>
                                             <div class="o_kanban_record" style=" background-color: #dbe3da;"> 
                                                <button style=" position:absolute; width:100%; height:25%; background:none; border:none;" title="open" type="object" name="action_open_record" context="{'default_freight_id': parent.id}"/>
                                                <div t-attf-class="oe_kanban_content oe_kanban_global_click oe_semantic_html_override oe_kanban_color_1" style="">
                                                    <div class="d-flex flex-column">
                                                        
                                                        <div class="" style="float:left; margin-top; 10px;" >
                                                            <span class="o_tag_badge_text"><field name="employee" /></span>
                                                            
                                                        </div>
                                                        <div class="o_field_many2manytags o_field_widget"> 
                                                            <div class="badge badge-pill o_tag_color_7" style="float:right; margin-top: -15px;">
                                                                <field name="state_id"/> 
                                                            </div>
                                                        </div>
                                                        
                                                        
                                                        <div  style="float:left;">
                                                            <span class="o_tag_badge_text"><field name='quotation_ref_num'/></span>
                                                        </div>
                                                        <div  style="float:left;">
                                                            <span>Valid until: <field name="valid_until_date" /></span>
                                                        </div>

                                                        <div style="border-bottom: 1px solid black;"/>
                                                    </div>
                                                </div>
                                             
                                                <div style="height:100px ; overflow-y:scroll; overflow-x:hidden;"> 
                                                <t t-value='0' t-set='count'/>
                                                <t t-value='0' t-set='helper'/>
                                                
                                                    <t t-set="data" t-value="record.quotation_data.raw_value.split('||')"/>
                                                        <t t-foreach="data" t-as='service'>
                                                            <t t-set="ser" t-value="service.split(':')"/>
                                                            <div ><t t-esc='ser[0]'/>:<span style= "float:right;"><t  t-esc='ser[1]'/></span></div>
                                                            
                                                        </t>
                                                
                                                <br/>
                                                </div>
                                                
                                                <!-- Total cost: <field name="total_cost"/> -->
                                                <div class="text-right">
                                                    <br/>
                                                    <div style="border-bottom: 1px solid black;"/>
                                                    <span style="float:left;">Freight type:<field name="freights_type_ids"/> </span>
                                                    <span>ETT: <field name="ett_min"/>-<field name="ett_max"/>days</span>
                                                </div>
                                            </div>
                                        </t>
                                    </templates>
                                </kanban>
                            </field>
                        </page>
                        <!-- <page string="Order" name="orderinfo" attrs="{'invisible': [('route_shipment_boolean','!=',True)]}">

                        </page>
                        <page string="Route" name="routes" attrs="{'invisible': [('route_shipment_boolean','!=',True)]}">

                        </page> -->
                        <page string="Order" name="shipment" attrs="{'invisible': [('route_shipment_boolean','!=',True)]}">
                            <field name="ordered_freights_type" string="Type"/>
                            <group>
                                <field name="ett_max"/>
                                <field name="is_inspection"/>
                                <field name="has_tir"/>
                                <field name="recipients" widget="many2many_tags"/>
                            </group>
                            <field name='route_shipment_boolean' invisible ='1'/>
                            <field name="freights_route"  delete="0">
                                <tree string="Routes" delete="0">
                                    <field name="sequence" widget="handle"/>
                                    <field name="point" />
                                    <button name="delete_item" type="object" icon="fa-times" title="Delete" />
                                </tree>
                            </field>
                            <field name='route_shipment_boolean' invisible = '1'/>
                            <field name="freights_shipment" context="{'default_freight_id': id}" mode="kanban">
                                <kanban class="o_kanban_mobile">
                                    <!-- <control>
                                        <create name="add_product_control" string="Add a Service" />
                                    </control> -->
                                    <field name="name"/>
                                    <field name="shipment_type_id_related"/>
                                    <field name="container_type_id"/>
                                    <field name="container_type_id_name"/>
                                    <!-- <field name="taras_id_name"/> -->
                                    
                                    <field name="track_number"/>
                                    <!-- <field name="container_details"/> -->
                                    <field name="cargo_currency_id"/>
                                    <field name="cargo_price"/>
                                    <field name='shipment_packages'/>
                                    <field name='records_count'/>
                                    
                                    <field name="shipment_data"/>
                                    <templates>
                                        <t t-name="kanban-box">
                                            <t t-set="data" t-value="record.shipment_data.raw_value.split('||')"/>
                                            <div t-attf-class="oe_kanban_content oe_kanban_global_click oe_semantic_html_override">
                                                <div class="d-flex flex-column justify-content-between">
                                                    <field name="name" /> 
                                                    <field name="records_count" /> Cargos
                                                    <field name="shipment_type_id_related" /> 
                                                    <field name="track_number"/>
                                                    <div class="o_field_many2manytags o_field_widget"> 
                                                            <div class="badge badge-pill o_tag_color_7" style="float:left;">
                                                                <field name='container_type_id_name' /> 
                                                            </div>
                                                            <div class="badge badge-pill o_tag_color_1" style="float:left;">
                                                                <field name='taras_id_name' /> 
                                                            </div>
                                                        </div>
                                                    <!-- <field name="track_number"/> -->
                                                    <!-- <field name="container_details"/> -->
                                                    <div style="border-bottom: 1px solid black;"/>
                                                    <div>
                                                        <b>Consignee:</b><b t-esc="data[0]" style="float:right"/>
                                                    </div>
                                                    <div>
                                                        <b>Phone:</b><b t-esc="data[1]" style="float:right"/>
                                                    </div>
                                                    <div>
                                                        <b>Cargo:</b><b t-esc="data[2]" style="float:right"/>
                                                    </div>
                                                    <div>
                                                        <b>Recipients:</b><b t-esc="data[3]" style="float:right"/>
                                                    </div>
                                                    <div>
                                                        <b>Status</b><b t-esc="data[4]" style="float:right"/>
                                                    </div>
                                                    <div>
                                                        <b>Note</b><b t-esc="data[5]" style="float:right"/>
                                                    </div>
                                                    <div>
                                                        <span>qty:</span><b><t t-esc="data[6]"/>pcs</b>, <span>vol:</span><b><t t-esc="data[7]"/>cbm</b>, <span>gw</span><b><t t-esc="data[8]"/>kg</b>
                                                    </div>

                                                    
                                                    <!-- <t t-if="len(o.referance_ids) > 1"> -->
                                                    <div class="text-right">
                                                        <br/>
                                                        <div style="border-bottom: 1px solid black;"/>
                                                        <span style="float:left;"><button name="duplicate_item" type="object" icon="fa-copy" class="btn fa fa-copy text-warning" title="Duplicate" confirm="Are you sure you want to duplicate this?"/></span>
                                                        <span><button name="delete_item" type="object" icon="fa-times" class="btn fa fa-times-circle text-danger" title="Delete" confirm="Are you sure you want to delete this?"/></span>
                                                        
                                                    </div>
                                                    <!-- </t> -->
                                                </div>
                                            </div>
                                        </t>
                                    </templates>
                                </kanban>
                            </field>
                        </page>
                        <page string="Tracking" name="tracking" attrs="{'invisible': [('route_shipment_boolean','!=',True)]}">  
                            <field name="freights_shipment_remark" readonly="0">
                                <tree string="Remark" editable="bottom" create="0" delete="false">
                                        <field name='freights_shipment'/>
                                        <field name="delay_domain" invisible="1"/>
                                        <field name="remark" />
                                        <field name="expected_actual"  readonly="1"/>
                                        <field name="delay_days"  readonly="1"/> 
                                        <field name="freights_delay_cat"/>
                                        <field name="freights_delay_reason" domain="delay_domain"/>
                                        <field name="delay"/>
                                </tree>
                            </field>
                            <header> 
                                <button string=' ATA ' name='custom_date_ata' type='object'/>
                                <button string=' ATD ' name='custom_date_atd' type='object'/>
                                <button string=' ETA ' name='custom_date_eta' type='object'/>
                                <button string=' ETD ' name='custom_date_etd' type='object'/>
                            </header>
                            <field name="freights_routes_shipment" widget="ml_worldwide_widget" readonly="0">
                                <tree string="Tracking" default_order="route_point_new,shipment_id asc" create="0" delete="false">
                                    <control>
                                        <create name="add_product_control" string="Add a Service" />
                                        <create name="add_section_control" string="Add a section" context="{'default_display_type': 'line_section'}"/>
                                    </control>
                                        <field name='route_point_new' invisible="1"/>
                                        <field name="shipment_id"  readonly="1"/>
                                        <field name="etd_date"/>
                                        <field name="atd_date"/>
                                        <field name="eta_date"/>
                                        <field name="ata_date"/>
                                        <field name='sequence' invisible="1"/>
                                </tree>
                            </field>
                           
                        </page>
                        <page string="Payments" name="payments" attrs="{'invisible': [('freights_payments', '=', [] )]}">
                            <header> 
                                <button string='Add record' name='add_records_to_payment' type='object'/>
                                <button string='Create Order &#38; Invoice' name='create_order_invoice' type='object' class='btn-primary'/>
                            </header>
                             <field attrs="{'readonly':True }" name="currency_ids">
                                <tree editable="bottom" style="width:300px">
                                    <field name="currency_id"/>
                                    <field name="rate"/>
                                    <field name="company_id" invisible="1"/>
                                </tree>
                            </field>
                            <field name="freights_payments" context="{'default_freight_id': id}" widget="ml_worldwide_widget" readonly="0">
                                <tree string="Services" default_order="shippment_ids"  >
                                    <control>
                                        <create name="add_product_control" string="Add a Service" />
                                        <create name="add_section_control" string="Add a section" context="{'default_display_type': 'line_section'}"/>
                                    </control>
                                    <!-- <button name="show_wizard" type="object" icon="fa-plane" attrs="{'invisible': [('transport_type','!=','AIR')]}"/>
                                    <button name="show_wizard" type="object" icon="fa-ship" attrs="{'invisible': [('transport_type','!=','OCEAN')]}"/>
                                    <button name="show_wizard" type="object" icon="fa-train" attrs="{'invisible': [('transport_type','!=','RAIL')]}"/>
                                    <button name="show_wizard" type="object" icon="fa-truck" attrs="{'invisible': [('transport_type','!=','ROAD')]}"/>
                                    <button name="show_wizard" type="object" icon="fa-random" attrs="{'invisible': [('transport_type','!=','Multimodal')]}"/> -->
                                    <field name="shippment_ids" readonly = "0" widget="many2many_tags"/>
                                    <field name="base_currency" invisible="1"/>
                                    
                                    <field name="payer_id" readonly = "1"/>
                                    <!-- <field name="service_rate" widget="monetary" decoration-success="is_invoiced == True"/> -->
                                    <field name="converted_rate" widget="monetary" options="{'currency_field': 'base_currency'}" />
                                    
                                    <field name="agent_id" readonly = "1"/>
                                    <field name="service_from" readonly = "1"/>
                                    <field name="service_to" readonly = "1"/>
                                    <field name="service_desc" readonly = "1" optional="hide"/>
                                    <field name="service_qty" optional="hide"/>
                                    <field name="currency_id" optional="hide"/>
                                    <!-- <field name="is_ordered" readonly="1"/> -->
                                    <field name="ett" optional="hide" />
                                    <field name="valid_until_date" optional="hide" />
                                    <field name="transport_type" optional="hide" />
                                    <!-- <field name='is_invoiced' optional="show"/> -->
                                    <field name="service_cost" widget="monetary"/>
                                    <field name="converted_cost" widget="monetary" options="{'currency_field': 'base_currency'}"/>
                                    <field name="converted_margin" widget="monetary" options="{'currency_field': 'base_currency'}"/>
                                    <!-- <field name="subtotal_cost" widget="monetary" readonly="1"/>
                                    <field name="subtotal_rate" widget="monetary" readonly="1"/> -->
                                    <!-- <button name="show_wizard" type="object" icon="fa-edit" title="Edit" /> -->
                                </tree>
                            </field>
                        </page>
                        <page string="Agent review" name="agent_review" attrs="{'invisible': [('freights_agent_review', '=', [] )]}">
                            <field name="freights_agent_review">
                                <tree string="Agent reviews" editable="bottom" create="false" delete="false" no_open="1">
                                    <field name="agent_id" readonly = "1"/>
                                    <field name="freight_id" readonly = "1"/>
                                    <field name="rate" widget="priority"/>
                                    <field name="review" />
                                </tree>
                            </field>
                        </page>
                    </notebook>

                    <!--<group expand="1">
                        <group>
                            <field name="is_show_details" />
                        </group>
                        <group>
                            <field name="invoice_id" widget="many2many_taglinks"/>
                        </group>
                    </group>

                     <div class="oe_title">
                        <group> 
                            <field name="" />
                            <field name="" />
                        </group>
                    </div> -->


                </sheet>
                <div class="oe_chatter" editable="bottom">
                    <field name="message_follower_ids"/>
                    <field name="activity_ids" type="html" options="{'collaborative': true}"/>
                    <field name="message_ids"/>
                </div>
            </form>
        </field>
    </record>
    
    <record id="ml_worldwide_freight_tree_view" model="ir.ui.view">
        <field name="name">mlworldwide.freights.tree</field>
        <field name="model">mlworldwide.freights</field>
        <field name="field_parent" eval="False"/>
        <field name="arch" type="xml">
            <tree string="Freights" sample="1" multi_edit="1">
                <field name="create_uid"/>
                <field name="ref_num" />
                <field name="freigths_type" widget="many2many_tags"/>
                <field name="customer_id"/>
                <field name="origin_term"/>
                <field name="origin_point_id"/>
                <field name="destination_term"/>
                <field name="destination_point_id"/>
                <!-- <field name="customer_id" position="attributes">
                    <attribute name="domain">"[('freigths_type.type_name','in', 'employee.user_freight_types.type_name')]"</attribute>
                </field>
                <field name="total_cost" widget="monetary"/>
                <field name="currency_id" />
                <field name="remark" />
                <button name="show_wizard" type="object" icon="fa-plane" attrs="{'invisible': [('transport_type','!=','AIR')]}"/>
                <button name="show_wizard" type="object" icon="fa-ship" attrs="{'invisible': [('transport_type','!=','OCEAN')]}"/>
                <button name="show_wizard" type="object" icon="fa-train" attrs="{'invisible': [('transport_type','!=','RAIL')]}"/>
                <button name="show_wizard" type="object" icon="fa-truck" attrs="{'invisible': [('transport_type','!=','ROAD')]}"/>-->
                <field name="contributor_ids" widget="many2many_tags"/>
                <field name="employee" optional="hide"/>
                <field name="state_id" /> 
                <field name="is_assigned_freights" invisible="1"/> 
                <field name="freights_quotations" widget="many2many_tags"/>
                <field name="freights_shipment" widget="many2many_tags"/>
                <field name="create_date"/>
               
                <button name="action_assign_freights" 
                    type="object" 
                    icon="fa-sign-language" 
                    string=" Assign" 
                    class="btn-primary" 
                    attrs="{'invisible': [('is_assigned_freights','=',False)]}"
                />    
                <!-- <field name="show_wgn" optional="hide"/> 
                <field name="show_volgross" optional="hide"/>  
                <field name="show_remark" optional="show"/>  -->
                <!-- '|',('state', '!=', 'Quotation'),  1, []  -->
            </tree>
           
        </field>
    </record>

    <record id="ml_worldwide_freight_kanban_view" model="ir.ui.view">   
        <field name="name">mlworldwide.freights.kanban</field>
        <field name="model">mlworldwide.freights</field>
        <field name="arch" type="xml">
            <kanban default_group_by="state_id" group_create="false">
                <field name="state_id"/>
                <!-- <field name="state"/> -->
                <field name="ref_num"/>
                <field name="employee"/>
                <field name="origin_term"/>
                <field name="destination_term"/>
                <field name="contributor_ids"/>
                <field name="create_date"/>
                <field name="has_insurance"/>
                <field name="dangerous_goods"/>
                <field name="is_prepaid"/>
                <progressbar field="state_id" colors="{&quot;done&quot;: &quot;success&quot;, &quot;blocked&quot;: &quot;danger&quot;, &quot;normal&quot;: &quot;muted&quot;}"/>
                <templates>
                    <t t-name="kanban-box">
                        <div t-attf-class="oe_kanban_global_click">
                            <div class="row" style="background-color: #4ede31; color: white;">
                                <div class="col-6">
                                    <strong><field name="ref_num"/></strong>
                                </div>
                                <div class="col-6 text-right">
                                    <field name='create_date'/>
                                    <!-- <t t-if="state = 'Confirmed'">
                                        <span class="badge badge-pill color-2"><field name="state"/></span>
                                    </t>
                                    <t t-else="">
                                        <span class="badge badge-pill color-1"><field name="state"/></span>
                                    </t> -->
                                </div>
                            </div>
                            <div style="height: 35px; overflow: auto">
                                <strong>Participants: <field name='contributor_ids'/></strong>
                            </div>
                            <div>
                                <div class='row' style='margin-left: 2px;'>
                                    <div style='background-color: #3d9bff; width : 30px; border-radius: 10px; text-align: center; color: white;'><field name="origin_term"/></div>
                                    <div style='background-color: red; width : 30px; border-radius: 10px; text-align: center; color: white;'><field name="destination_term"/></div>
                                    <!-- <t t-if="state = 'Confirmed'">
                                        <span class="badge badge-pill color-2" style='font-size: 10px;'><field name="state"/></span>
                                    </t>
                                    <t t-else="">
                                        <span class="badge badge-pill color-1"><field name="state"/></span>
                                    </t> -->
                                </div>
                                <strong>Employee: </strong><field name="employee"/><br/>
                                <strong>Has insurance: </strong><field name='has_insurance' widget="boolean_checkbox"/><br/>
                                <strong>Is dangerous: </strong><field name='dangerous_goods' widget="boolean_checkbox"/><br/>
                                <strong>Prepaid order: </strong><field name='is_prepaid' widget="boolean_checkbox"/><br/>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <record id="ml_worldwide_freight_pivot_view" model="ir.ui.view">
        <field name="name">mlworldwide.freights.pivot</field>
        <field name="model">mlworldwide.freights</field>
        <field name="arch" type="xml">
            <pivot string="Freights Analysis" sample="1">
                <field name="freigths_type" type="col"/>
                <field name="create_date" interval="month" type="row"/>
                <field name="volume" type="measure"/>
            </pivot>
        </field>
    </record>

    <record id="ml_worldwide_freight_graph_view" model="ir.ui.view">
        <field name="name">mlworldwide.freights.graph</field>
        <field name="model">mlworldwide.freights</field>
        <field name="arch" type="xml">
            <graph string="Freights Analysis" type="line" sample="1">
                <field name="freigths_type"/>
                <field name="volume" type="measure"/>
            </graph>
        </field>
    </record>

    <record id="ml_worldwide_freight_search_view" model="ir.ui.view">
        <field name="name">mlworldwide.freights.search</field>
        <field name="model">mlworldwide.freights</field>
        <field name="arch" type="xml">
            <search>
                <field name="customer_id" string="Customer"  />
                <field name ="contributor_ids" string ="Participants" />     
                <field name ="freigths_type" string="Freight Type"/>
                <field name="ref_num" string="Ref"/>
                <field name ="state_id" string="Status"/>
                <field name ="freights_shipment" string="Shipment"/>
                <field name ="origin_point_id" string="Origin Point"/>
                <field name ="destination_point_id" string="Destination Point"/>
            </search>
        </field>
    </record>

    <record id="ml_worldwide_freight_action" model="ir.actions.act_window">
        <field name="name">Freights</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">mlworldwide.freights</field>
        <field name="view_mode">tree,form,kanban,pivot,graph</field>
        <field name="view_id" eval="False"/>
        <field name="usage">menu</field>
        <field name="help" type="html">
            <p class="o_view_nocontent_smiling_face">
                Define a new pages
            </p><p>
                Freights app are used to Pages module.
            </p>
        </field>
    </record>

    <menuitem id="menu_worldwide_freight"
              name="Freights"
              action="ml_worldwide_freight_action"
              parent="menu_worldwide_master"
              groups=""
              sequence="101"/>

</odoo>
